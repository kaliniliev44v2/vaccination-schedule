{% extends "base.html" %}
{% block content %}
<div class="container">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="text-primary">
      <i class="bi bi-people"></i> Моите пациенти
    </h2>
    <a href="/patients/new" class="btn btn-success">
      <i class="bi bi-person-plus"></i> Нов пациент
    </a>
  </div>
  
  {% if patients %}
    <div class="row">
      {% for patient in patients %}
      <div class="col-md-6 col-lg-4 mb-4">
        <div class="card h-100 shadow-sm">
          <div class="card-body">
            <h5 class="card-title text-primary">
              <i class="bi bi-person"></i> {{ patient.first_name }} {{ patient.last_name }}
            </h5>
            <p class="card-text">
              <small class="text-muted"><i class="bi bi-card-text"></i> ЕГН:</small> 
              <code>{{ patient.egn }}</code><br>
              <small class="text-muted"><i class="bi bi-calendar"></i> Роден:</small> 
              {{ patient.birth_date.strftime('%d.%m.%Y') }}
            </p>
            
            <div class="d-grid gap-2">
              <div class="btn-group" role="group">
                <a href="/patients/{{ patient.id }}/edit" class="btn btn-outline-warning btn-sm">
                  <i class="bi bi-pencil"></i> Редакция
                </a>
                <a href="/patients/{{ patient.id }}/vaccines" class="btn btn-outline-primary btn-sm">
                  <i class="bi bi-shield-check"></i> Ваксини
                </a>
              </div>
              
              <form method="post" action="/patients/{{ patient.id }}/delete" 
                    onsubmit="return confirm('⚠️ Сигурни ли сте, че искате да изтриете {{ patient.first_name }} {{ patient.last_name }}?\n\nВсички данни за ваксини също ще бъдат изтрити!');" 
                    class="mt-2">
                <button class="btn btn-outline-danger btn-sm w-100" type="submit">
                  <i class="bi bi-trash"></i> Изтрий
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    
    <div class="mt-4 text-muted text-center">
      <small>Общо пациенти: <strong>{{ patients|length }}</strong></small>
    </div>
  {% else %}
    <div class="text-center mt-5">
      <div class="card shadow-sm mx-auto" style="max-width: 500px;">
        <div class="card-body p-5">
          <i class="bi bi-people text-muted" style="font-size: 4rem;"></i>
          <h4 class="mt-3 text-muted">Няма добавени пациенти</h4>
          <p class="text-muted">Започнете като добавите първия си пациент</p>
          <a href="/patients/new" class="btn btn-success btn-lg">
            <i class="bi bi-person-plus"></i> Добавете първия пациент
          </a>
        </div>
      </div>
    </div>
  {% endif %}
</div>
{% endblock %}